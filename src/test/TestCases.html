<html>
<body>
<h1><a href="https://addons.mozilla.org/en-US/firefox/addon/thumbnail-zoom-plus/">
Thumbnail Zoom Plus</a> Test Cases</h1>

[<a href="http://0.0.0.0:8000/test/TestCases.html">local http version</a>]<br>

<h2>General Instructions</h2>
<p>Test in the most recent released version of Firefox, the beta, the nightly, and the oldest supported (eg version 3).
<p>Run tests in Private Browsing mode so they don't depend on your "logged-in" 
state (but the drawback is that if you fix a bug and want to restart, you'll lose the browser's state).
<p>Try tests with both http and https (on Twitter you may need to change
a Twitter site pref to enable http).
<ul>
<li>Test basic popping up of thumbs.
<li>Verify that the popup dismisses when you mouse away from the thumb, click the page,
press Escape, switch tabs, use Control-L and enter a different URL, navigate away by
the back or forward keys, or close the window with Control-W / Apple-W
<li>Display popup; then drag page to open space to open in new window.  The 
hover thumb in the dragged page.  Verify that popup appears in the new page 
and not in the old one.
<li>Repeat tab-dragging, but back into original window.
<li>After testing, open the Error Console (Shift+Apple+r) and verify no errors from
the add-on.
<li>Perform the following tests with non-default page zoom.
<li>Instead of moving mouse onto a thumb, scroll thumb to be under mouse (using mouse
wheel or track pad).  Verify that popup appears.  Scroll thumb out of mouse.
Verify that popup disappears.
<li>Test for factors related to the geometry of the thumb, image, and browser window.  
<li>Verify correct placement of the popup adjcent to or on top of the thumb (depending on the preference).
<li>Test with all languages for which the add-on has translations (see its locale dir).
Set in about:config general.useragent.locale, with intl.locale.matchOS=false.
</ul>

<h2>Direct Links To Images</h2>
Note: Thumbnail Zoom Plus doesn't work on file:// links (it's a
security restriction).  So to test these links, you must either:
<ul>
<li>temporarily set enableFileProtocol=true in filterService.js; or
<li>Run <kbd>python -m SimpleHTTPServer &amp;</kbd> in .../thumbnail-zoom/src to
create a local web site and access the page <a href="http://0.0.0.0:8000/TestCases.html">
from your machine over http</a>
</ul>
Tests:
<ul>
<li><a href="http://www.reddit.com/r/all">Reddit</a> links to images on imgur, quickmeme.com, and qkme.me
should show popup images (except Imgur galleries, which have /a/ in their link).  Links to
YouTube videos should work too.
<li><a href="http://www.tumblr.com/tagged/japan">Tumblr</a>: images sometimes link to images
hosted on tumblr.com; those links should show popups.
<li>Examples of direct links to images:

<li>Thumb not linked to anything, and already at 100:
<img src="http://d.thumbs.redditmedia.com/Z4st3vIRrgG81YQ-.jpg" />
<li>Thumb not linked to anything, but at reduced size:
<img src="http://d.thumbs.redditmedia.com/Z4st3vIRrgG81YQ-.jpg" width="40" height="30" />

<li>Regular existing image:<br>&nbsp;&nbsp;
<a href="http://imgur.com/KFC9m">text part of link
<img src="http://d.thumbs.redditmedia.com/Z4st3vIRrgG81YQ-.jpg" />
</a>

<li>Big gif image; good for testing busy cursor (clear cache to see slow loading again):<br>&nbsp;&nbsp;
<a href="http://imgur.com/7ZFpN">text part of link
<img src="http://d.thumbs.redditmedia.com/49LfQjFPXCoXYC-W.jpg" />
</a>
<li>A <a href="gradient.jpg">gradient image</a> and a 
<a href="gradient_corrupt.jpg">corrupt gradient image</a>.
<li><a href="non-existing-image.jpg">Non-existent image URL on existing host</a> (fast error)
<li>Image on non-existent host (use to make sure there are no exceptions; may take a couple minutes
to timeout):<br>&nbsp;&nbsp;
<a href="http://1.0.0.0/non-existent-server.jpg">
[http://1.0.0.0/non-existent-server.jpg]
</a>
</ul>
</ul>

<h2>Multi-Site Thumbs</h2>
This tests whether a thumb for a particular site like Amazon works when
the hosting page is on another site:<br>
[Firefox movie DVD thumb:]
<img src="http://ecx.images-amazon.com/images/I/51wiDE5xT6L._AA115_.jpg">

<h2>Facebook</h2>
<ul>
<li>Test both when logged in and logged out; it affects the image host.
<li><a href="https://www.facebook.com/Levis?sk=wall">Facebook: Levi's: Wall</a>.  
<ul>
  <li>Verify popup on "Levis" small profile thumb, photo thumbs at top of page,
larger photos on the Wall.  
  <li>Click a wall photo after its 
popup appears.  Verify that the popup is dismissed as the photo opens in its Theater-mode page.
  <li>After popup appears, use Control+L / Apple-L and enter facebook.com.  
Verify that popup dismisses.  Verify that popups work on the page you now have loaded.
</ul>
<li><a href="https://www.facebook.com/Levis?sk=videos">Facebook: Levi's: Videos</a>.  
Hover a video and make sure a popup appears.
<li>Also try a variety of hovers on your own wall, including posts from apps
and shared links.
</li>
</ul>


<h2>Twitter</h2>
<ul>
<li>Log into Twitter and go to the <a href="http://twitter.com/#!/activity">Activity tab</a>.
  <ul>
    <li>
Hover over the medium profile thumbs in the left-most column and verify popup.
    <li>
    Hover over a large thumb of a person who was "followed", in the same box as a "follow" button.
    (Doesn't currently work except sometimes when entered from below; a div
    covers the img so we don't get an event when mouse hovers the img).
  </ul>
<li>Go to <a href="http://twitter.com/?lang=en#!/cnn">cnn's twitter page</a>.
<ul>
  <li>Hover over the small profile icons of people "Similar to".
  <li>Hover over the tiny profile icons of people "Following".
  <li>Scroll through CNN's feed, looking for the icon which indicates there's a pic.  Click on such tweets; then
  in the right-hand pane, hover the image.  
  <blockquote>Debugging tip: when you click the tweet, a new (nested) document loads; watch the log to
  verify it's detected as twitpic.
</ul>
<li>Try the same in <a href="https://twitter.com/?lang=es#!/CNN/">cnn's twitter page in Spanish and https</a>,
which used to cause problems since it uses a different host for images.
<li><a href="http://twitter.com/?lang=en#!/CNN/media/grid">CNN's Images</a>: 
Hover over the images.  It may not work for images from all sources,
but should work for twitpic, yfrog, and instagr.am images.
<li>https and Spanish version of <a href="https://twitter.com?lang=es#!/TheRomMistress/media/grid">a user's images.</a>
<li>Do similar tests on <a href="http://twitter.com?lang=en#!/TheRomMistress/media/grid">same in http English.</a>
</ul>


<h2>TwitPic</h2>
<p>Note that we can't work on thumbs hosted at http://s3.amazonaws.com/
since their URL includes a key which prevents us from changing it to
a non-thumb.</p>
<ul>
<li><a href="http://twitpic.com/">TwitPic home page</a>: 
<ul>
<li>hover over small thumbs in Latest Photos From Users area.  
<li>Hover over medium Popular Users profile thumbs.
<li>Hover over large What's Trending thumbs.
</ul>
<li><a href="http://twitpic.com/search#q=rockies&type=mixed&page=1">TwitPic Search Results</a>:
Hover over medium results thumbs.
<li><a href="http://twitpic.com/public_timeline/">Public Timeline</a>
<li><a href="http://twitpic.com/public_timeline/feed.rss">RSS feed</a>
</ul>


<h2>Google Images</h2>
<ul><li>Search on <a href="https://www.google.com/search?hl=en&q=pizza&bav=on.2,or.r_gc.r_pw.,cf.osb&biw=1396&bih=741&noj=1&um=1&ie=UTF-8&tbm=isch&source=og&sa=N&tab=wi">
Google Images</a>.  Hover a thumb to see Google's slightly bigger popup.  Hover the thumb in that popup to see the add-on's popup.
</ul>

<h2>Google Plus</h2>
<ul><li><a href="https://plus.google.com/102150693225130002912/posts">Posts page</a>: should see popup for profile icons of various sizes
(if G+ pops up its own little popup, hover the image in that).  Hover photos in the stream.  
</ul>

<h2>GMail</h2>
<ul>
<li>Go to <a href="https://gmail.com">gmail.com</a>, log into your mailbox, and find a message with image attachments.  Hover
the attachment thumbs and you should see the images.
</ul>



<h2>Flickr</h2>
<ul>
<li><a href="http://www.flickr.com/search/?q=grand+teton&f=hp">Flickr search results</a>: hover over results thumbs, 
with thumbs at Small, Medium, and Detail sizes.
<li><a href="http://www.flickr.com/photos/sathishcj/2887178930/sizes/s/in/photostream/">A particular photo's page</a>:
Hover over ithe image itself at sizes Square, Thumbnail, Small, Medium 500, Medium 640.
<li>Thumbnail Zoom Plus doesn't do popups from profile icons.
</ul>


<h2>YouTube</h2>
<ul>
<li><a href="http://www.youtube.com/">Main page</a>: 
Hover over movie thumbs and links.
<li><a href="http://www.reddit.com/r/videos">youtube links on reddit</a>
</ul>

<h2>deviantArt</h2>
<ul>
<li><a href="http://www.deviantart.com/">deviantArt home</a>: 
<ul>
<li>popups should appear from images, and should disappar when you click an image (which tests the hash-change listener).
<li>because thumbs are laid out in a grid covering most of the page, and images tend to be large, this is a good
site to test popup positioning.  Try with Maximize Image Size By Overlapping Thumbnail both off and on.  With it off, verify that images
are positioned with an edge neary touching the thumb, and opposite edge touching the edge
of the browser (assuming it's a large image).  Test on horizontal and vertical aspect
images.  Test with page zoomed in and out.
<li>Hovering over a profile link should show a small popup if the profile has a 
jpg profile pic (but not if it's gif unfortunately).
</ul>
</ul>


<h2>MySpace</h2>


<h2>LinkedIn</h2>
<li><a href="http://www.linkedin.com/pub/dir/?first=john&last=doe&search=Search&searchType=fps">
Search Results</a>: hover profile icons.

<h2>Amazon</h2>
<ul><li><a href="http://www.amazon.com/">Main page</a>: hover product thumbs (More Items To Consider)
<li><a href="http://www.amazon.com/Variety-Chips-Nutter-Butter-12-Count/dp/B003VMW0ZC/ref=sr_1_5?ie=UTF8&qid=1322031667&sr=8-5">
Oreos product page</a>: hover product image and its icon for bigger image.
<li><a href="https://www.amazon.co.uk/gp/product/B002LL16JK/ref=s9_hps_gw_g74_ir04?pf_rd_m=A3P5ROKL5A1OLE&pf_rd_s=center-5&pf_rd_r=0XMFZ1CM2PRHFQQK5RWD&pf_rd_t=101&pf_rd_p=277960247&pf_rd_i=468294">
https://amazon.co.uk</a>
</ul>

<h2>Picasa</h2>


<h2>Last.fm</h2>
<ul>
<li><a href="http://www.last.fm/charts">Charts</a>: hover over album thumbs
<li><a href="http://www.last.fm/community">Community</a>: Profile thumbs
<li><a href="http://www.last.fm/charts">Charts</a>: hover over album thumbs
<li><a href="http://www.lastfm.es/charts">In Spanish</a>
</ul>

<h2>okCupid</h2>
You should see large images when hovering thumbs in
<a href="http://www.okcupid.com/match?fromWhoOnline=1">okcupid Who's Online</a>.

<h2>Hi5</h2>


<h2>Tagged</h2>


<h2>Photobucket</h2>

<h2>Pinterest</h2>


<h2>Wikipedia</h2>


<h2>IMDB</h2>


<h2>DailyMile</h2>


<h2>Engadget</h2>


<h2>Imgur</h2>


<h2>Photosight.ru</h2>


<h2>Memory Usage: Images Area</h2>
Make sure Thumbnail Zoom Plus isn't leaking memory and that the memory it does use
is garbage-collected easily.  You can check memory usage in the about:memory page.
<br>
To Setup The Test Conditions:
<ol>
<li>Close all browser tabs and windows.
<li>Open a single window and open the default page of deviantart.com 
(a good site for testing since it tends to have high-res images). 
Set the view mode to Popular All-Time, so the images shown won't change during the test.
<li>Open a second window and open about:memory?verbose . 
Arrange the windows side-by-side.
<li>Turn off AutoPager (if it was on) so its loading doesn't affect memory.
</ol>
To Perform A Test:
<ol>
<li>Restart the browser (to clear memory to a consistent state)
<li>After the windows finish loading, click "GC" and note the total memory size under <kdb>explicit<kbr>
and especially the size used by images in <kbd>images</kbd> (you can use Find and Highight All to find it).
<li>Hover over each thumbnail to see its popup image, for at 16 images.
<li>Press "GC" in the about window to update.  Re-check <kdb>explicit<kbr> and <kbd>images</kbd> memory usage.
<li>Press "CC" in the about window.  Re-check <kdb>explicit<kbr> and <kbd>images</kbd> memory usage.
<li>Press "Minimize memory" in the about window.  Re-check <kdb>explicit<kbr> and <kbd>images</kbd> memory usage.
<li>Then repeat the test (without restarting); memory usage shouldn't be much more.
<li>When it's working well, size after "CC" after hovering should be about same as size after GC 
but before hovering.  And size after Minimize should be about the same.
<li>Example results (1.6.0beta3 2011-12-, Firefox 8.0.1 OSX):
<ul>
<li>before: 10.8M
<li>after GC after hovering 12 images: 14.5M
<li>after CC: 10.8M
<li>after Minimize memory: 10.8M
</ul>
<li>In Thumbnail Zoom (not Plus) 1.4.3, memory usage was 36M even after "Minimize memory".
</ol>

<h2>Memory Usage: Zombie Document Compartments</h2>
Background: <a href="https://github.com/dadler/thumbnail-zoom/issues/24">
github issue 24</a>
<br>
To test:
<ul>
<li>Disable Ad-Block Plus and any other extensions which may cause Zombie Compartment leaks.
<li>Close all windows and tabs except one, which has a page to be tested, 
such as <a href="http://0.0.0.0:8000/test/TestCases.html">http://0.0.0.0:8000/test/TestCases.html</a> .
<li>Open about:memory?verbose in another tab.
<li>Restart the browser.
<li>Hover over each of the links in the "Direct Links To Images" section,
including the ones for non-existent links.
<li>Close the tab of the test page.
<li>In the memory window, press Minimize Memory Use.
<li>Look for "compartment(http://0.0.0.0:8000/test/TestCases.html)".
<li>If you find it, it indicates a zombie compartment, which is a problem.  But if it goes
away after a couple minutes, it may just be waiting for the
connection to non-existent server to timeout.
<li>If it looks clean, try the same test with facebook.com instead of the TestCases page.
<li>This issue is seen in TZP 1.5.8 and 1.6.0beta3.
<li>Press Back in the google.com tab if you want to restart and repeat the test.
</ul>


<h2>Speed</h2>
Do a regression test to compare the speed of an old version of the add-on with a new version.  
Test each version and compare.  Measuremeans are only meaningful within a short time of
each other since conditions vary.  It may take multple tests to get a reliable
result.<br>
<ol>
<li>To test, load the deviantart home page.  
<li>Clear the browser cache (of Everything -- all time).
<li>Using a stopwatch with 100th of a second, hover on an image and 
time how long it takes from when you enter the thumb to when the image appears.
Do this for 12 images, accumulating the time into a timer.
</ol>
Examples:
<ul>
<li>TZP 1.5.8: 8.4, 8.0, 8.7 seconds
<li>TZP 1.6.0beta3 2011-12-04: 8.7, 8.6, 10.3
<br>
(end)
</body>
</html>
